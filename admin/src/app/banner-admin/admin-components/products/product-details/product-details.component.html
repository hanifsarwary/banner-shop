<div class="container">
  <div class="product-detail" align="center" *ngIf="!loading">
    <div class="heading mt-3">Product Detail</div>
    <hr>
    <div class="card">
        <div class="row product-section">
          <div class="col-5 pl-0">
            <div [class.content]="editProductId">
                <img [src]="imgFlag ? updateImg : utils.getImage(productDetail?.default_product_image)" class="card-img" alt="...">
                <input style="display: none" type="file" [disabled]="!editProductId" (change)="onSelectFile($event)" #hiddenfileinput>
                <div class="content-overlay" [disabled]="!editProductId"></div>
                <div [disabled]="!editProductId" class="content-details d-flex flex-column justify-content-center fadeIn-bottom">
                  <i (click)="hiddenfileinput.click()"></i>
                </div>
            </div>
          </div>
          <div class="col-7">
            <div class="card-body">
              <h5 class="card-title card-heading input mb-0 mt-3 mb-3"> 
                <input [class.applyBorder]="!editProductId"  class="form-control form-control-sm" [disabled]="!editProductId" type="text" [(ngModel)]="productDetail.product_name">
              </h5>
              <div class="row card-text">
                <div class="col-4"> Weight Unit : </div>
                <div class="col-8 product-description">
                  <input [class.applyBorder]="!editProductId" [disabled]="!editProductId" class="form-control form-control-sm" type="text" [(ngModel)]="productDetail.weight_unit">
                </div>
              </div>
              <div class="row card-text">
                  <div class="col-4"> One Unit Weight : </div>
                  <div class="col-8 product-description">
                    <input [class.applyBorder]="!editProductId" [disabled]="!editProductId" class="form-control form-control-sm" type="text" [(ngModel)]="productDetail.one_unit_weight">
                  </div>
              </div>
              <div class="row card-text">
                <div class="col-4"> Price  Type: </div>
                <div class="col-8 product-description">
                  <select [class.applyBorder]="!editProductId" [disabled]="!editProductId"  (change)="showByPriceType($event)" [(ngModel)]="productDetail.price_type" class="form-control form-control-sm" id="producPriceType">
                    <option  *ngFor="let item of pricesData | keyvalue" [value]="item.key">{{item.value}}</option>
                  </select>
                </div>
              </div>
              <div *ngIf="priceType === '1'" class="ml-0 mr-0">
                <div class="card-text row">
                    <div class="col-4"> Price : </div>
                    <div class="col-8 product-description">
                      <input type="number" min="1" class="form-control form-control-sm" [(ngModel)]="price">
                    </div>
                </div>
                <div class="card-text row">
                    <label class="col-sm-4 col-form-label">Option 1:</label>
                    <div class="col-8 product-description">
                      <input type="text" min="1" class="form-control form-control-sm" [(ngModel)]="width_option">
                    </div>
                </div>
                <div class="card-text row">
                    <label class="col-sm-4 col-form-label">Option 2:</label>
                    <div class="col-8 product-description">
                      <input type="text" min="1" class="form-control form-control-sm" [(ngModel)]="height_option">
                    </div>
                </div>
              </div>
              <div *ngIf="priceType === '4'" class="ml-0 mr-0">
                  <div class="card-text row">
                      <label class="col-sm-4 col-form-label">Option 1:</label>
                      <div class="col-8 product-description">
                        <input type="text" min="1" class="form-control form-control-sm" [(ngModel)]="option_1">
                      </div>
                  </div>
                  <div class="card-text row">
                      <label class="col-sm-4 col-form-label">Option 2:</label>
                      <div class="col-8 product-description">
                        <input type="text" min="1" class="form-control form-control-sm" [(ngModel)]="option_2">
                      </div>
                  </div>
              </div>
              <div *ngIf="priceType === '11'" class="ml-0 mr-0">
                  <div class="card-text row">
                      <label class="col-sm-4 col-form-label">Option 1:</label>
                      <div class="col-8 product-description">
                        <input type="text" min="1" class="form-control form-control-sm" [(ngModel)]="option_1">
                      </div>
                  </div>
                  <div class="card-text row">
                      <label class="col-sm-4 col-form-label">Option 2:</label>
                      <div class="col-8 product-description">
                        <input type="text" min="1" class="form-control form-control-sm" [(ngModel)]="option_2">
                      </div>
                  </div>
                  <div class="card-text row">
                      <label class="col-sm-4 col-form-label">Option 3:</label>
                      <div class="col-8 product-description">
                        <input type="text" min="1" class="form-control form-control-sm" [(ngModel)]="option_3">
                      </div>
                  </div>
              </div>
              <div *ngIf="priceType === '5'" class="ml-0 mr-0">
                  <div class="card-text row">
                      <label class="col-sm-4 col-form-label">Select Range:</label>
                      <div class="col-sm-8">
                          <div class="d-flex justify-content-between price-type-2 p-0 m-0">
                              <label for="col-form-label label-size">Min :</label>
                              <input type="number" min="1" class="form-control form-control-sm input-size" [(ngModel)]="min_value">
                              <label for="col-form-label label-size">Max :</label>
                              <input type="number" min="1" class="form-control form-control-sm input-size" [(ngModel)]="max_value">
                          </div>
                      </div>
                  </div>
                  <div class="card-text row">
                      <label class="col-sm-4 col-form-label">Total :</label>
                      <div class="col-8 product-description">
                        <input type="text" class="form-control form-control-sm" [(ngModel)]="cal_price">
                      </div>
                  </div>
              </div>
              <div class="row card-text">
                <div class="col-4"> Setup  Cost: </div>
                <div class="col-8 product-description" >
                  <input [class.applyBorder]="!editProductId" [disabled]="!editProductId" class="form-control form-control-sm" type="text" [(ngModel)]="productDetail.setup_cost">
                </div>
              </div>
              <div class="row card-text">
                <div class="col-4"> Product Description : </div>
                <div class="col-8 product-description" [innerHTML]="productDetail.product_description | renderHtml">
                  <!-- <input [class.applyBorder]="!editProductId" [disabled]="!editProductId" class="form-control form-control-sm" type="text" [(ngModel)]="productDetail.product_description"> -->
                  <!-- <code><pre>{{productDetail.product_description}}</pre></code> -->
                </div>
              </div>
              <div class="row pull-right product-edit">
                <a href="javascript:;" *ngIf="!editProductId" (click)="openProductModal(productModal)">Edit</a>
                <a href="javascript:;" *ngIf="editProductId" (click)="saveProduct(productDetail)">Save</a>
                <a href="javascript:;" *ngIf="editProductId" (click)="cancelProduct()">Cancel</a>
              </div>
            </div>
          </div>
        </div>
    </div>
    <div class="card">
      <div class="card-header bg-white d-flex flex-row justify-content-between">
        <h5 class="mt-2 font-weight-bold">Product Options</h5>
        <div class="product-edit mt-1 mr-2">
            <button class="btn btn-primary" (click)="openProductOptionModal(subOptionModal)">Add</button>
        </div>
      </div>
      <div class="card-body p-0 m-0">
        <table *ngIf="productSubOption.length" class="table table-fixed" align="center">
          <thead>
              <tr>
                  <th class="col-2">Option Name</th>
                  <th class="col-2">Price Unit</th>
                  <th class="col-3">Option Type</th>
                  <th class="col-3">Option Description</th>
                  <th class="col-1"></th>
                  <th class="col-1"></th>
              </tr>
          </thead>
          <tbody>
              <tr *ngFor="let item of productSubOption">
                  <td class="col-2"><input class="form-control form-control-sm" [disabled]="recordId!==item.id" type="text" [(ngModel)]="item.option_name"></td>
                  <td class="col-2"><input class="form-control form-control-sm" [disabled]="recordId!==item.id" type="text" [(ngModel)]="item.price_unit"></td>
                  <td class="col-3">
                    <select [disabled]="recordId!==item.id" [(ngModel)]="item.option_type" class="form-control form-control-sm" id="optionType">
                      <option  *ngFor="let item of optionsData | keyvalue" [value]="item.key">{{item.value}}</option>
                    </select>
                  </td>
                  <td class="col-3"><input class="form-control form-control-sm" [disabled]="recordId!==item.id" type="text" [(ngModel)]="item.option_description"></td>
                  <td class="col-1">
                    <a *ngIf="recordId !== item.id" (click)="editOption(item.id)" href="javascript:;"> <small>Edit</small></a>
                    <a *ngIf="recordId === item.id" (click)="saveOptions(item)" href="javascript:;"> <small>Save</small></a>
                  </td>
                  <td class="col-1"> <a (click)="openModal(subOptionModal, item.suboption_set)" href="javascript:;" ><small>sub option</small></a></td>
              </tr>
          </tbody>
        </table>
        <div *ngIf="!productSubOption.length" class="text-center mt-3">No options</div>
      </div>
    </div>
  </div>
</div>

<div class="d-flex justify-content-center" [class.d-block]="loading">
  <ngx-spinner size="medium" color="#fff" type="ball-scale-multiple">
  </ngx-spinner>
</div>

<ng-template #subOptionModal let-modal>
  <div class="modal-header">
   <h5 class="modal-title" id="editProfileLabel">Edit Sub Option</h5>
   <button type="button" class="close" (click)="modal.dismiss()" aria-label="Close">
    <span aria-hidden="true">&times;</span>
   </button>
  </div>
  <div class="modal-body">
    <div class="sub-option" *ngIf="subOption.length">
      <table class="table mat-elevation-z8 table-fixed" align="center">
        <thead>
            <tr>
                <th class="col-5">Name</th>
                <th class="col-5">Price</th>
                <th class="col-2"></th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let item of subOption">
                <td class="col-5"><input class="form-control form-control-sm" [disabled]="subOptionId!==item.id" type="text" [(ngModel)]="item.name"></td>
                <td class="col-5"><input class="form-control form-control-sm" [disabled]="subOptionId!==item.id" type="text" [(ngModel)]="item.price"></td>
                <td class="col-2">
                  <a *ngIf="subOptionId !== item.id" (click)="editSubOption(item.id)" href="javascript:;"> Edit</a>
                  <a *ngIf="subOptionId === item.id" (click)="saveSubOption(item)" href="javascript:;"> Save</a>
                </td>
            </tr>
        </tbody>
      </table>
    </div>
    <div class="d-flex justify-content-center" *ngIf="!subOption.length">
      No sub option
    </div>
  </div>
 </ng-template>